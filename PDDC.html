<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pregnancy Calculator – Three-Column Results</title>
  <style>
    :root {
      --bg-light: #f5f7fb;
      --accent: #4a90e2;
      --border: #d0d4e0;
      --font-main: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background-color: var(--bg-light);
      font-family: var(--font-main);
      color: #333;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
    }

    .wrapper {
      max-width: 1100px;
      width:100%;
    }

    h2 {
      text-align: center;
      margin-bottom: 1.5rem;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .container {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      flex-wrap: wrap;
      justify-content: center;
    }

    .column {
      flex: 1 1 500px; /*used to change min width of columns*/
      background: #fff;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      box-sizing: border-box;
    }

    label {
      font-weight: 500;
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.3rem;
      font-size: 0.95rem;
    }

    .date-group {
      display: flex;
      gap: 0.4rem;
    }

    .date-group input {
      width: 100%;
      max-width: 75px;
      padding: 0.4rem;
      font-size: 0.95rem;
      text-align: center;
      border-radius: 6px;
      border: 1px solid var(--border);
      box-sizing: border-box;
    }
    .ga-us-group {
      display: flex;
      max-width: 70px;
      width: 75%;
      gap: 0.4rem;
    }

    .ga-us-group input {
      flex: 1;
    }

    input[type="number"] {
      /*width: 100%;*/
      padding: 0.4rem;
      font-size: 0.95rem;
      text-align: center;
      border-radius: 6px;
      border: 1px solid var(--border);
      box-sizing: border-box;
    }

    /* Results table card */
    .results-card {
      background: #fff;
      border-radius: 12px;
      padding: 1.2rem 1.2rem 1.4rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      box-sizing: border-box;
    }

    .results-title {
      font-weight: 600;
      margin-bottom: 0.8rem;
      font-size: 1rem;
    }

    .results-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }

    .results-table th,
    .results-table td {
      padding: 0.5rem 0.6rem;
      border-bottom: 1px solid #eceff5;
      text-align: center;
      vertical-align: middle;
    }

    .results-table th:first-child,
    .results-table td:first-child {
      text-align: left;
      font-weight: 500;
      color: #555;
      width: 40%;
    }

    .results-table th {
      font-weight: 600;
      background: #f0f3fa;
      border-bottom: 1px solid #d9deea;
    }

    .results-table td span {
      font-weight: 600;
      color: #222;
    }

    /* @media (max-width: 820px) {
      .container {
        flex-direction: column;
      }
    }*/
  </style>
</head>
<body>
  <div class="wrapper">
    <h2>Pregnancy Calculator</h2>

    <div class="container">
      <!-- INPUT COLUMN -->
      <div class="column">
        <label>LMP (YYYY-MM-DD):</label>
        <div class="date-group">
          <input id="lmpYear" maxlength="4" placeholder="YYYY">
          <input id="lmpMonth" maxlength="2" placeholder="MM">
          <input id="lmpDay" maxlength="2" placeholder="DD">
        </div>

        <label>EDD (YYYY-MM-DD):</label>
        <div class="date-group">
          <input id="eddYear" maxlength="4" placeholder="YYYY">
          <input id="eddMonth" maxlength="2" placeholder="MM">
          <input id="eddDay" maxlength="2" placeholder="DD">
        </div>

        <label>Cycle Length (days):</label>
        <input type="number" id="cycleLength" value="28" min="20" max="45">

        <label>First Ultrasound Date (YYYY-MM-DD):</label>
        <div class="date-group">
          <input id="usYear" maxlength="4" placeholder="YYYY">
          <input id="usMonth" maxlength="2" placeholder="MM">
          <input id="usDay" maxlength="2" placeholder="DD">
        </div>

        <label>GA at First Ultrasound:</label>
        <div class="ga-us-group">
          <input type="number" id="usWeeks" placeholder="weeks" min="0" max="40">
          <input type="number" id="usDays" placeholder="days" min="0" max="6">
        </div>

        <label>Specific Date (YYYY-MM-DD):</label>
        <div class="date-group">
          <input id="customYear" maxlength="4" placeholder="YYYY">
          <input id="customMonth" maxlength="2" placeholder="MM">
          <input id="customDay" maxlength="2" placeholder="DD">
        </div>
      </div>

      <!-- OUTPUT COLUMN: TABLE WITH 3 COLUMNS (LMP / US / EDD) -->
      <div class="column results-card">
        <div class="results-title">Results</div>
        <table class="results-table">
          <thead>
            <tr>
              <th></th>
              <th>LMP</th>
              <th>US</th>
              <th>EDD</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Due date</td>
              <td><span id="dueLMPCell"></span></td>
              <td><span id="dueUSCell"></span></td>
              <td><span id="dueEDDCell"></span></td>
            </tr>
            <tr>
              <td>GA today</td>
              <td><span id="gaTodayLMPCell"></span></td>
              <td><span id="gaTodayUSCell"></span></td>
              <td><span id="gaTodayEDDCell"></span></td>
            </tr>
            <tr>
              <td>GA on specific date</td>
              <td><span id="gaDateLMPCell"></span></td>
              <td><span id="gaDateUSCell"></span></td>
              <td><span id="gaDateEDDCell"></span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    function buildDateFromInputs(prefix) {
      const y = document.getElementById(prefix + "Year").value;
      const m = document.getElementById(prefix + "Month").value;
      const d = document.getElementById(prefix + "Day").value;
      if (y.length === 4 && m.length === 2 && d.length === 2) {
        const year = parseInt(y, 10);
        const month = parseInt(m, 10);
        const day = parseInt(d, 10);
        if (
          Number.isNaN(year) || Number.isNaN(month) || Number.isNaN(day) ||
          month < 1 || month > 12 || day < 1 || day > 31
        ) {
          return null;
        }
        return new Date(year, month - 1, day);
      }
      return null;
    }

    function formatGA(days) {
      if (days === null || Number.isNaN(days) || days < 0 || days > 320) return null;
      const w = Math.floor(days / 7);
      const d = days % 7;
      return `${w}w ${d}d`;
    }

    function calcDueFromLMP(lmp, cycleLength = 28) {
      const base = new Date(lmp.getTime());
      base.setDate(base.getDate() + 280 + (cycleLength - 28));
      return base;
    }

    function calcDueFromUS(usDate, usWeeks, usDays) {
      const base = new Date(usDate.getTime());
      const totalDays = (usWeeks * 7 + usDays);
      base.setDate(base.getDate() + (280 - totalDays));
      return base;
    }

    function calcGA(dueDate, targetDate) {
      if (!dueDate || !targetDate) return null;
      return 280 - Math.round((dueDate - targetDate) / 86400000);
    }

    function setCellText(id, text) {
      const cell = document.getElementById(id);
      cell.textContent = text && text !== "–" ? text : "";
    }

    function updateOutputs() {
      const today = new Date();
            today.setHours(0, 0, 0, 0);
      const cycleLength = parseInt(document.getElementById("cycleLength").value, 10);

      const usWeeks = parseInt(document.getElementById("usWeeks").value, 10);
      const usDays = parseInt(document.getElementById("usDays").value, 10) || 0;

      const lmp = buildDateFromInputs("lmp");
      const edd = buildDateFromInputs("edd");
      const usDate = buildDateFromInputs("us");
      const customDate = buildDateFromInputs("custom");

      const dueLMP = lmp && !Number.isNaN(cycleLength) ? calcDueFromLMP(lmp, cycleLength) : null;
      const dueUS = (usDate && !Number.isNaN(usWeeks)) ? calcDueFromUS(usDate, usWeeks, usDays) : null;
      const dueEDD = edd || null;

      // Due dates
      setCellText("dueLMPCell", dueLMP ? dueLMP.toISOString().split("T")[0] : "");
      setCellText("dueUSCell", dueUS ? dueUS.toISOString().split("T")[0] : "");
      setCellText("dueEDDCell", dueEDD ? dueEDD.toISOString().split("T")[0] : "");

      // GA today
      const gaTodayLMPDays = calcGA(dueLMP, today);
      const gaTodayUSDays  = calcGA(dueUS, today);
      const gaTodayEDDDays = calcGA(dueEDD, today);

      setCellText("gaTodayLMPCell", formatGA(gaTodayLMPDays));
      setCellText("gaTodayUSCell", formatGA(gaTodayUSDays));
      setCellText("gaTodayEDDCell", formatGA(gaTodayEDDDays));

      // GA on specific date
      if (customDate) {
        const gaDateLMPDays = calcGA(dueLMP, customDate);
        const gaDateUSDays  = calcGA(dueUS, customDate);
        const gaDateEDDDays = calcGA(dueEDD, customDate);

        setCellText("gaDateLMPCell", formatGA(gaDateLMPDays));
        setCellText("gaDateUSCell", formatGA(gaDateUSDays));
        setCellText("gaDateEDDCell", formatGA(gaDateEDDDays));
      } else {
        setCellText("gaDateLMPCell", "");
        setCellText("gaDateUSCell", "");
        setCellText("gaDateEDDCell", "");
      }
    }

    // Auto-focus behaviour for date segments
    ["lmp", "edd", "us", "custom"].forEach(prefix => {
      const yearInput  = document.getElementById(prefix + "Year");
      const monthInput = document.getElementById(prefix + "Month");
      const dayInput   = document.getElementById(prefix + "Day");

      yearInput.addEventListener("input", function () {
        if (this.value.length === 4) monthInput.focus();
      });

      monthInput.addEventListener("input", function () {
        if (this.value.length === 2) dayInput.focus();
      });
    });

    // Trigger recalculation on all relevant inputs
    document.querySelectorAll("input").forEach(input => {
      input.addEventListener("input", updateOutputs);
    });
  </script>
</body>
</html>
